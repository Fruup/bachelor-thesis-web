import{O as Te,P as te,S as R,i as z,s as X,e as W,b as N,H as _e,g as H,v as Z,d as B,f as F,h as b,o as J,k as I,l as A,m as M,n as E,Q as ne,E as C,R as U,T as re,U as se,V,N as le,a as P,c as q,W as He,X as ie,Y as j,q as Le,y as ye,Z as G,r as Ce,z as ge,A as pe,_ as oe,$ as Se,B as ve,a0 as Ie,w as Ae}from"../chunks/index.d0a34214.js";import{w as x}from"../chunks/index.1f6444f9.js";function we(r){const e=r-1;return e*e*e+1}function ae(r,{delay:e=0,duration:n=400,easing:t=Te}={}){const s=+getComputedStyle(r).opacity;return{delay:e,duration:n,easing:t,css:l=>`opacity: ${l*s}`}}function K(r,{delay:e=0,duration:n=400,easing:t=we,x:s=0,y:l=0,opacity:i=0}={}){const a=getComputedStyle(r),o=+a.opacity,f=a.transform==="none"?"":a.transform,_=o*(1-i),[m,y]=te(s),[c,g]=te(l);return{delay:e,duration:n,easing:t,css:(w,k)=>`
			transform: ${f} translate(${(1-w)*m}${y}, ${(1-w)*c}${g});
			opacity: ${o-_*k}`}}function ce(r){let e,n,t,s,l,i,a,o,f,_;return{c(){e=I("button"),n=I("img"),this.h()},l(m){e=A(m,"BUTTON",{type:!0,class:!0});var y=M(e);n=A(y,"IMG",{class:!0,src:!0,alt:!0}),y.forEach(b),this.h()},h(){E(n,"class","detail-image svelte-17ms1nj"),ne(n.src,t=r[3])||E(n,"src",t),E(n,"alt",r[2]),E(e,"type","button"),E(e,"class","image-detail-mask svelte-17ms1nj")},m(m,y){N(m,e,y),C(e,n),o=!0,f||(_=_e(e,"click",r[9]),f=!0)},p(m,y){r=m,(!o||y&8&&!ne(n.src,t=r[3]))&&E(n,"src",t),(!o||y&4)&&E(n,"alt",r[2])},i(m){o||(U(()=>{o&&(l&&l.end(1),s=re(n,r[5],{}),s.start())}),U(()=>{o&&(a&&a.end(1),i=re(e,ae,{duration:100}),i.start())}),o=!0)},o(m){s&&s.invalidate(),l=se(n,K,r[4]),i&&i.invalidate(),a=se(e,ae,{duration:r[1]}),o=!1},d(m){m&&b(e),m&&l&&l.end(),m&&a&&a.end(),f=!1,_()}}}function Ne(r){let e,n,t,s,l=r[0]&&ce(r);return{c(){l&&l.c(),e=W()},l(i){l&&l.l(i),e=W()},m(i,a){l&&l.m(i,a),N(i,e,a),n=!0,t||(s=_e(window,"keydown",r[6]),t=!0)},p(i,[a]){i[0]?l?(l.p(i,a),a&1&&H(l,1)):(l=ce(i),l.c(),H(l,1),l.m(e.parentNode,e)):l&&(Z(),B(l,1,1,()=>{l=null}),F())},i(i){n||(H(l),n=!0)},o(i){B(l),n=!1},d(i){l&&l.d(i),i&&b(e),t=!1,s()}}}const ue="image-detail-button";function Me(r,e,n){let t,s,{element:l}=e,{visible:i=!1}=e,{durationIn:a=250}=e,{durationOut:o=500}=e;const f={duration:o,y:50};J(()=>{const c=l.parentElement;if(!c||c.tagName==="BUTTON"&&c.className===ue)return;const g=document.createElement("button");g.addEventListener("click",()=>n(0,i=!0)),g.className=ue,c.insertBefore(g,l),g.appendChild(l)});const _=c=>{const g=l.getBoundingClientRect(),w=c.getBoundingClientRect(),k=g.x-w.x,p=g.y-w.y,S=g.width/w.width,L=g.height/w.height;return{css:(T,h)=>`
				translate: ${h*k}px ${h*p}px;
				scale: ${S+T*(1-S)} ${L+T*(1-L)};
			`,duration:a,easing:we}},m=c=>{i&&c.key==="Escape"&&n(0,i=!1)},y=()=>n(0,i=!1);return r.$$set=c=>{"element"in c&&n(7,l=c.element),"visible"in c&&n(0,i=c.visible),"durationIn"in c&&n(8,a=c.durationIn),"durationOut"in c&&n(1,o=c.durationOut)},r.$$.update=()=>{r.$$.dirty&128&&n(3,t=l.src),r.$$.dirty&128&&n(2,s=l.alt)},[i,o,s,t,f,_,m,l,a,y]}class Be extends R{constructor(e){super(),z(this,e,Me,Ne,X,{element:7,visible:0,durationIn:8,durationOut:1})}}function Oe(r,e,n){let t,{mathContainer:s}=e,l=1;const i=()=>{l!==1?n(1,l=1):(n(1,l=s.clientWidth/s.scrollWidth),s.scrollTo({left:0,top:0,behavior:"smooth"}))};return J(()=>{n(0,s.onclick=()=>i(),s),i()}),r.$$set=a=>{"mathContainer"in a&&n(0,s=a.mathContainer)},r.$$.update=()=>{r.$$.dirty&1&&(t=s.firstElementChild),r.$$.dirty&3&&s.classList.toggle("fit",l!==1),r.$$.dirty&2&&(t.style.scale=l.toString())},[s,l]}class De extends R{constructor(e){super(),z(this,e,Oe,null,X,{mathContainer:0})}}const Pe=r=>{const e=r.querySelectorAll('a[href^="#"]:not([data-is-citation])'),n=Array.from(e.values()).map(t=>{const s=()=>{let l;try{l=r.querySelector(t.getAttribute("href")??"_")}catch{return}l&&($.set(l),be.set(t))};return t.addEventListener("mouseenter",s),s});return{destroy:()=>{e.forEach((t,s)=>t.removeEventListener("mouseenter",n[s]))}}},$=x(null),be=(()=>{const r=x(null),e=()=>{r.set(null),$.set(null)};return{subscribe:r.subscribe,set:n=>{const t=V(r);t&&t.removeEventListener("mouseleave",e),n==null||n.addEventListener("mouseleave",e),r.set(n)}}})();function fe(r){let e,n,t,s,l,i,a;return{c(){e=I("div"),n=I("div"),t=P(),s=I("div"),this.h()},l(o){e=A(o,"DIV",{style:!0,class:!0});var f=M(e);n=A(f,"DIV",{class:!0});var _=M(n);_.forEach(b),t=q(f),s=A(f,"DIV",{class:!0}),M(s).forEach(b),f.forEach(b),this.h()},h(){E(n,"class","content"),E(s,"class","gradient"),E(e,"style",r[5]),E(e,"class","preview svelte-46vjkm"),U(()=>r[13].call(e))},m(o,f){N(o,e,f),C(e,n),n.innerHTML=r[3],C(e,t),C(e,s),l=He(e,r[13].bind(e)),a=!0},p(o,f){(!a||f&8)&&(n.innerHTML=o[3]),(!a||f&32)&&E(e,"style",o[5])},i(o){a||(U(()=>{a&&(i||(i=ie(e,K,{y:20},!0)),i.run(1))}),a=!0)},o(o){i||(i=ie(e,K,{y:20},!1)),i.run(0),a=!1},d(o){o&&b(e),l(),o&&i&&i.end()}}}function qe(r){let e,n,t=r[4]&&r[2]&&fe(r);return{c(){t&&t.c(),e=W()},l(s){t&&t.l(s),e=W()},m(s,l){t&&t.m(s,l),N(s,e,l),n=!0},p(s,[l]){s[4]&&s[2]?t?(t.p(s,l),l&20&&H(t,1)):(t=fe(s),t.c(),H(t,1),t.m(e.parentNode,e)):t&&(Z(),B(t,1,1,()=>{t=null}),F())},i(s){n||(H(t),n=!0)},o(s){B(t),n=!1},d(s){t&&t.d(s),s&&b(e)}}}function Ve(r,e,n){let t,s,l,i,a,o,f;le(r,be,p=>n(11,o=p)),le(r,$,p=>n(12,f=p));let _=0,m=0,y,c,g=!1,w;function k(){y=this.clientWidth,c=this.clientHeight,n(0,y),n(1,c)}return r.$$.update=()=>{if(r.$$.dirty&4096&&n(2,t=f),r.$$.dirty&2048&&n(10,s=o),r.$$.dirty&516&&(t?n(9,w=setTimeout(()=>n(8,g=!0),500)):(n(8,g=!1),clearTimeout(w))),r.$$.dirty&260&&n(4,l=g&&t),r.$$.dirty&1235&&l&&s){const p=s.getBoundingClientRect();n(6,_=p.x+window.scrollX+p.width/2-y/2),p.y<window.innerHeight/2?n(7,m=p.y+p.height):n(7,m=p.y-p.height-c),n(6,_=Math.max(0,Math.min(window.innerWidth-y,_))),n(7,m=Math.max(0,Math.min(window.innerHeight-c,m))),n(6,_+=window.scrollX),n(7,m+=window.scrollY)}r.$$.dirty&192&&n(5,i=`--x: ${_}px; top: ${m}px;`),r.$$.dirty&12&&n(3,a=(()=>{let S="",L=t;for(let T=0;L&&T<3;T++)S+=L.outerHTML,L=L.nextElementSibling;return S})())},[y,c,t,a,l,i,_,m,g,w,s,o,f,k]}class We extends R{constructor(e){super(),z(this,e,Ve,qe,X,{})}}const Ue=r=>typeof r.scrollPosition=="number"&&typeof r.toHash=="string",D=x([]),Ee=r=>{let e=null;try{if(e=document.querySelector(r),!e)return!1}catch{return!1}return e.scrollIntoView({behavior:"smooth"}),!0},Re=r=>{window.scrollTo({top:r,behavior:"smooth"})},ze=r=>e=>{e.preventDefault(),Ee(r.hash);const n={scrollPosition:window.scrollY,toHash:r.hash};history.pushState(n,r.hash,r.hash),D.update(t=>t.concat(n))},Q=r=>{const e=V(D).length;if(e){for(;r<0;)r+=e;Re(V(D)[r].scrollPosition),D.update(n=>[...n.slice(0,r),...n.slice(r+1)])}},me=r=>Q(r.detail),Xe=r=>{window.addEventListener("popstate",t=>{const{state:s}=t;Ue(s)?(D.update(l=>[...l,s]),Ee(s.toHash)):V(D).length&&(Q(-1),t.preventDefault())}),window.addEventListener("",t=>{V(D).length&&(Q(-1),t.preventDefault())}),r.addEventListener("history:restore",me);const e=r.querySelectorAll('a[href^="#"]'),n=Array.from(e.values()).map(t=>{const s=ze(t);return t.addEventListener("click",s),s});return{destroy:()=>{e.forEach((t,s)=>t.removeEventListener("click",n[s])),r.removeEventListener("history:restore",me)}}};function he(r,e,n){const t=r.slice();return t[10]=e[n],t}function de(r){let e,n;return e=new Be({props:{element:r[10]}}),{c(){ye(e.$$.fragment)},l(t){ge(e.$$.fragment,t)},m(t,s){pe(e,t,s),n=!0},p(t,s){const l={};s&2&&(l.element=t[10]),e.$set(l)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){ve(e,t)}}}function Ye(r){let e,n,t,s,l=`<style scoped>${r[3]}</style>`,i,a,o,f,_,m,y,c,g=r[4].html+"",w,k,p,S,L,T=r[1],h=[];for(let u=0;u<T.length;u+=1)h[u]=de(he(r,T,u));const ke=u=>B(h[u],1,1,()=>{h[u]=null});return k=new We({}),{c(){e=I("div");for(let u=0;u<h.length;u+=1)h[u].c();n=P(),t=I("div"),s=new j(!1),i=P(),a=new j(!1),o=P(),f=I("section"),_=I("h2"),m=Le("Bibliography"),y=P(),c=new j(!1),w=P(),ye(k.$$.fragment),this.h()},l(u){e=A(u,"DIV",{class:!0});var v=M(e);for(let Y=0;Y<h.length;Y+=1)h[Y].l(v);v.forEach(b),n=q(u),t=A(u,"DIV",{class:!0});var d=M(t);s=G(d,!1),i=q(d),a=G(d,!1),o=q(d),f=A(d,"SECTION",{class:!0});var O=M(f);_=A(O,"H2",{});var ee=M(_);m=Ce(ee,"Bibliography"),ee.forEach(b),y=q(O),c=G(O,!1),O.forEach(b),d.forEach(b),w=q(u),ge(k.$$.fragment,u),this.h()},h(){E(e,"class","image-details"),s.a=i,a.a=o,c.a=null,E(f,"class","bibliography svelte-um1gdn"),E(t,"class","container svelte-um1gdn")},m(u,v){N(u,e,v);for(let d=0;d<h.length;d+=1)h[d]&&h[d].m(e,null);N(u,n,v),N(u,t,v),s.m(l,t),C(t,i),a.m(r[2],t),C(t,o),C(t,f),C(f,_),C(_,m),C(f,y),c.m(g,f),r[6](t),N(u,w,v),pe(k,u,v),p=!0,S||(L=[oe(Xe.call(null,t)),oe(Pe.call(null,t))],S=!0)},p(u,[v]){if(v&2){T=u[1];let d;for(d=0;d<T.length;d+=1){const O=he(u,T,d);h[d]?(h[d].p(O,v),H(h[d],1)):(h[d]=de(O),h[d].c(),H(h[d],1),h[d].m(e,null))}for(Z(),d=T.length;d<h.length;d+=1)ke(d);F()}},i(u){if(!p){for(let v=0;v<T.length;v+=1)H(h[v]);H(k.$$.fragment,u),p=!0}},o(u){h=h.filter(Boolean);for(let v=0;v<h.length;v+=1)B(h[v]);B(k.$$.fragment,u),p=!1},d(u){u&&b(e),Se(h,u),u&&b(n),u&&b(t),r[6](null),u&&b(w),ve(k,u),S=!1,Ie(L)}}}function je(r,e,n){let{data:t}=e;const{html:s,css:l,headings:i,bibliography:a}=t;let o,f=[];const _=()=>{const c=o.querySelectorAll(".math.math-display");for(const g of c)g.scrollWidth<=g.clientWidth||new De({target:g,props:{mathContainer:g}})},m=()=>{n(1,f=Array.from(o.querySelectorAll("img")))};J(()=>{_(),m()});function y(c){Ae[c?"unshift":"push"](()=>{o=c,n(0,o)})}return r.$$set=c=>{"data"in c&&n(5,t=c.data)},[o,f,s,l,a,t,y]}class Qe extends R{constructor(e){super(),z(this,e,je,Ye,X,{data:5})}}export{Qe as component};
